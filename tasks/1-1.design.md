# Design 1-1: Initialize Project Structure and Dependencies

## Requirements
- Create a clean project structure for the web terminal
- Install necessary dependencies
- Set up basic configuration files
- Ensure no conflict with existing telegram-ssh-terminal

## Solution

### Directory Structure
```
web-terminal/
├── src/
│   ├── server.js          # Main server class
│   ├── auth.js            # Authentication manager
│   ├── session.js         # Session manager
│   ├── terminal.js        # Terminal manager
│   ├── file-manager.js    # File operations
│   ├── monitoring.js      # Health checks
│   └── index.js           # Entry point
├── public/
│   ├── index.html         # Frontend page
│   ├── js/
│   │   └── terminal.js    # Frontend JavaScript
│   └── css/
│       └── styles.css     # Styles
├── tests/
│   ├── unit/
│   │   ├── auth.test.js
│   │   ├── session.test.js
│   │   └── terminal.test.js
│   └── integration/
│       └── e2e.test.js
├── config/
│   └── default.json       # Default configuration
├── package.json
├── .env.example
├── .gitignore
├── Dockerfile
├── docker-compose.yml
└── README.md
```

### Package.json Configuration
```json
{
  "name": "web-terminal",
  "version": "0.1.0",
  "description": "Secure web-based terminal application",
  "main": "src/index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "lint": "eslint src/ tests/",
    "docker:build": "docker build -t web-terminal .",
    "docker:run": "docker-compose up"
  },
  "dependencies": {
    "express": "^4.18.2",
    "socket.io": "^4.6.1",
    "node-pty": "^1.0.0",
    "jsonwebtoken": "^9.0.2",
    "bcrypt": "^5.1.1",
    "helmet": "^7.1.0",
    "cors": "^2.8.5",
    "express-rate-limit": "^7.1.5",
    "multer": "^1.4.5-lts.1",
    "ioredis": "^5.3.2",
    "winston": "^3.11.0",
    "dotenv": "^16.3.1"
  },
  "devDependencies": {
    "jest": "^29.7.0",
    "supertest": "^6.3.3",
    "nodemon": "^3.0.2",
    "eslint": "^8.55.0",
    "socket.io-client": "^4.6.1"
  },
  "engines": {
    "node": ">=18.0.0"
  }
}
```

### Environment Variables (.env.example)
```bash
# Server Configuration
NODE_ENV=development
PORT=3000

# Security
JWT_SECRET=change-this-secret-in-production
JWT_EXPIRES_IN=24h
BCRYPT_ROUNDS=10

# CORS
CORS_ORIGINS=http://localhost:3000

# Session
SESSION_IDLE_TIMEOUT=1800000
MAX_TERMINALS_PER_USER=5
CLEANUP_ON_DISCONNECT=false

# File System
BASE_DIR=/workspace
UPLOAD_MAX_SIZE=10485760
ALLOWED_UPLOAD_TYPES=.txt,.log,.json,.md,.sh,.py,.js,.ts

# Redis (optional)
REDIS_HOST=localhost
REDIS_PORT=6379

# Terminal
USE_TMUX=false
DEFAULT_SHELL=/bin/bash

# Performance
BACKPRESSURE_HIGH_WATERMARK=16384
OUTPUT_CHUNK_SIZE=4096

# CDN
USE_CDN=false
```

## Tests

### Installation Test
```bash
#!/bin/bash
# test_setup.sh
cd web-terminal
npm install
npm test -- --testMatch="**/setup.test.js"
```

### Setup Test (tests/unit/setup.test.js)
```javascript
describe('Project Setup', () => {
  test('should have all required directories', () => {
    const fs = require('fs');
    expect(fs.existsSync('./src')).toBe(true);
    expect(fs.existsSync('./public')).toBe(true);
    expect(fs.existsSync('./tests')).toBe(true);
  });
  
  test('should have all required dependencies', () => {
    const pkg = require('../package.json');
    expect(pkg.dependencies['express']).toBeDefined();
    expect(pkg.dependencies['socket.io']).toBeDefined();
    expect(pkg.dependencies['node-pty']).toBeDefined();
  });
  
  test('should load environment variables', () => {
    require('dotenv').config();
    expect(process.env.NODE_ENV).toBeDefined();
  });
});
```

## Implementation Steps
1. Create web-terminal directory
2. Initialize npm project
3. Install dependencies
4. Create directory structure
5. Add configuration files
6. Run setup tests